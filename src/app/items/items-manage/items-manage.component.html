<div class="sub-header">
    <h4>Items</h4>
</div>
<div class="expansion-action-buttons">
    <button mat-button (click)="accordion().openAll()">Expand All</button>
    <button mat-button (click)="accordion().closeAll()">Collapse All</button>
  </div>
<div class="accordion-padding">
  <mat-accordion class="expansion-headers-align" multi>
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title> Add Items </mat-panel-title>
        <mat-panel-description>
          <!-- <mat-icon>place_item</mat-icon> -->
        </mat-panel-description>
      </mat-expansion-panel-header>
      <form [formGroup]="itemForm" (change)="itemFormChanged(itemForm)">
        <mat-form-field>
          <mat-label>Date</mat-label>
          <input matInput [matDatepicker]="itemDatePicker" formControlName="date" (focus)="itemDatePicker.open()" readonly />
          <mat-datepicker #itemDatePicker></mat-datepicker>
        </mat-form-field>
        
        <mat-form-field>
          <mat-label>Item Name</mat-label>
          <mat-select formControlName="itemName" name="item">
            @for (item of itemsList; track item) {
              <mat-option [value]="item.itemId">{{item.itemName}}</mat-option>
            }
          </mat-select> 
        </mat-form-field>
  
        <mat-form-field>
          <mat-label>Procurement Type</mat-label>
          <mat-select formControlName="procurementType" name="procurement">
            @for (procurement of procurementKindList; track procurement) {
              <mat-option [value]="procurement.procurementId">{{procurement.procurementName}}</mat-option>
            }
          </mat-select> 
        </mat-form-field>

        <mat-form-field>
          <mat-label>Quantity</mat-label>
          <input matInput formControlName="quantity"/>
        </mat-form-field>

        <mat-form-field>
          <mat-label>One Quantity to K/P</mat-label>
          <input matInput formControlName="oneQuantityToKgOrPiece"/>
        </mat-form-field>

        <mat-form-field>
          <mat-label>BA for One Quantity</mat-label>
          <input matInput formControlName="buyingAmountForOneQuantity"/>
        </mat-form-field>

        <mat-form-field>
          <mat-label>Total Quantity in K/P</mat-label>
          <input matInput formControlName="totalQuantityInKgOrPiece"/>
        </mat-form-field>

        <mat-form-field>
          <mat-label>BA For One Quantity in K/P</mat-label>
          <input matInput formControlName="buyingAmountForOneQuantityInKgOrPiece"/>
        </mat-form-field>

        <mat-form-field>
          <mat-label>Total BA</mat-label>
          <input matInput formControlName="totalBuyingAmount"/>
        </mat-form-field>

        <mat-form-field>
          <mat-label>ESA</mat-label>
          <input matInput formControlName="expectedSellingAmount"/>
        </mat-form-field>

        <mat-form-field>
          <mat-label>ESA for K/P</mat-label>
          <input matInput formControlName="expectedSellingAmountForQuantityInKgOrPiece"/>
        </mat-form-field>
      </form>
      <ng-container>
        *BA - Buying Amount<br/>
        *ESA - Expected Selling Amount<br/>
        *K/P - Kg/Piece
      </ng-container>
      
      <button mat-flat-button class="button-right" (click)="submitItem()">
        Submit
      </button>
    </mat-expansion-panel>

    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title> Total Items Bought</mat-panel-title>
        <mat-panel-description>
          <!-- Select the Task and Assignee for the date -->
          <!-- <mat-icon>align_items_stretch</mat-icon> -->
        </mat-panel-description>
      </mat-expansion-panel-header>

      <div class="table-filter">
        <mat-form-field>
          <mat-label>Filter</mat-label>
          <input matInput (keyup)="applyFilterTotalItems($event)" placeholder="Ex. ium" #input>
        </mat-form-field>
      </div>
      
      <ng-container>
        *BA - Buying Amount<br/>
        *ESA - Expected Selling Amount<br/>
        *K/P - Kg/Piece
      </ng-container>

      <div class="table-container">
        <table mat-table [dataSource]="totalItemsDataSource" class="mat-elevation-z8 demo-table">
          <!-- Date Column -->
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let element">{{element.date}}</td>
          </ng-container>

            <!-- Item Name Column -->
            <ng-container matColumnDef="itemName">
                <th mat-header-cell *matHeaderCellDef>Item Name</th>
                <td mat-cell *matCellDef="let element">{{element.itemName}}</td>
              </ng-container>
            
            <!-- Quantity Name Column -->
            <ng-container matColumnDef="procurementType">
              <th mat-header-cell *matHeaderCellDef>Procurement Type</th>
              <td mat-cell *matCellDef="let element">{{element.procurementType}}</td>
            </ng-container>

            <!-- Quantity Column -->
            <ng-container matColumnDef="quantity">
              <th mat-header-cell *matHeaderCellDef>Quantity</th>
              <td mat-cell *matCellDef="let element">{{element.quantity}}</td>
            </ng-container>

            <!-- Quantity to Kg/Piece Column -->
            <ng-container matColumnDef="oneQuantityToKgOrPiece">
              <th mat-header-cell *matHeaderCellDef>One Quantity to K/P</th>
              <td mat-cell *matCellDef="let element">{{element.oneQuantityToKgOrPiece}}</td>
            </ng-container>

            <!-- Total Buying Amount For Quantity Column -->
            <ng-container matColumnDef="buyingAmountForOneQuantity">
              <th mat-header-cell *matHeaderCellDef>Total BA For One Quantity</th>
              <td mat-cell *matCellDef="let element">{{element.buyingAmountForOneQuantity}}</td>
            </ng-container>

            <!-- Total Quantity in Kg/Piece Column -->
            <ng-container matColumnDef="totalQuantityInKgOrPiece">
              <th mat-header-cell *matHeaderCellDef>Total Quantity in K/P</th>
              <td mat-cell *matCellDef="let element">{{element.totalQuantityInKgOrPiece}}</td>
            </ng-container>

             <!-- Buying Amount For Quantity in Kg/Piece Column -->
             <ng-container matColumnDef="buyingAmountForOneQuantityInKgOrPiece">
              <th mat-header-cell *matHeaderCellDef>BA For One Quantity in K/P</th>
              <td mat-cell *matCellDef="let element">{{element.buyingAmountForOneQuantityInKgOrPiece}}</td>
            </ng-container>

            <!-- Total Buying Amount Column -->
            <ng-container matColumnDef="totalBuyingAmount">
              <th mat-header-cell *matHeaderCellDef>Total BA</th>
              <td mat-cell *matCellDef="let element">{{element.totalBuyingAmount}}</td>
            </ng-container>

            <!--Expected Selling Amount Column -->
            <ng-container matColumnDef="expectedSellingAmount">
              <th mat-header-cell *matHeaderCellDef>ESA</th>
              <td mat-cell *matCellDef="let element">{{element.expectedSellingAmount}}</td>
            </ng-container>

            <!--Expected Selling Amount for Quantity in Kg/Piece Column -->
            <ng-container matColumnDef="expectedSellingAmountForQuantityInKgOrPiece">
              <th mat-header-cell *matHeaderCellDef>ESA for Quantity in K/P</th>
              <td mat-cell *matCellDef="let element">{{element.expectedSellingAmountForQuantityInKgOrPiece}}</td>
            </ng-container>

    
            <tr mat-header-row *matHeaderRowDef="totalItemsDisplayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: totalItemsDisplayedColumns;"></tr>

            <!-- Row shown when there is no matching data. -->
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" colspan="4">No data matching the filter "{{input.value}}"</td>
            </tr>
        </table>
      </div>

    </mat-expansion-panel>
  
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title> Items Sold </mat-panel-title>
        <mat-panel-description>
          <!-- <mat-icon>move_item</mat-icon> -->
        </mat-panel-description>
      </mat-expansion-panel-header>
  
      <div class="table-container">
        <table mat-table [dataSource]="soldItemsDataSource" class="mat-elevation-z8 demo-table">
            <!-- Date Column -->
            <ng-container matColumnDef="date">
              <th mat-header-cell *matHeaderCellDef>Date</th>
              <td mat-cell *matCellDef="let element">{{element.date}}</td>
            </ng-container>

            <!-- Item Name Column -->
            <ng-container matColumnDef="itemName">
                <th mat-header-cell *matHeaderCellDef>Item Name</th>
                <td mat-cell *matCellDef="let element">{{element.itemName}}</td>
              </ng-container>
        
            <!-- Quantity Column -->
            <ng-container matColumnDef="quantity">
              <th mat-header-cell *matHeaderCellDef>Quantity</th>
              <td mat-cell *matCellDef="let element">{{element.quantity}}</td>
            </ng-container>

            <!-- Amount Column -->
            <ng-container matColumnDef="amount">
              <th mat-header-cell *matHeaderCellDef>Amount</th>
              <td mat-cell *matCellDef="let element">{{element.amount}}</td>
            </ng-container>
        
            <tr mat-header-row *matHeaderRowDef="soldItemsDisplayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: soldItemsDisplayedColumns;"></tr>
        </table>
      </div>

    </mat-expansion-panel>

    <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title> Remaining Items </mat-panel-title>
          <mat-panel-description>
            <!-- <mat-icon>balance</mat-icon> -->
          </mat-panel-description>
        </mat-expansion-panel-header>
    
        <div class="table-container">
            <table mat-table [dataSource]="remainingItemsDataSource" class="mat-elevation-z8 demo-table">
                <!-- Item Name Column -->
                <ng-container matColumnDef="itemName">
                    <th mat-header-cell *matHeaderCellDef>Item Name</th>
                    <td mat-cell *matCellDef="let element">{{element.itemName}}</td>
                  </ng-container>
            
                <!-- Quantity Column -->
                <ng-container matColumnDef="quantity">
                  <th mat-header-cell *matHeaderCellDef>Quantity</th>
                  <td mat-cell *matCellDef="let element">{{element.quantity}}</td>
                </ng-container>
              
                <tr mat-header-row *matHeaderRowDef="remainingItemsDisplayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: remainingItemsDisplayedColumns;"></tr>
            </table>
          </div>
  
    </mat-expansion-panel>
  </mat-accordion>    
</div>
  
  